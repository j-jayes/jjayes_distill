<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Draft: Spanish Flu Mortality</title>

  <meta property="description" itemprop="description" content="This paper looks at mortality during the Spanish flu pandemic of 1918 in 15 districts in the Cape Province of South Africa."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-07-28"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-07-28"/>
  <meta name="article:author" content="Jonathan Jayes"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Draft: Spanish Flu Mortality"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="This paper looks at mortality during the Spanish flu pandemic of 1918 in 15 districts in the Cape Province of South Africa."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Draft: Spanish Flu Mortality"/>
  <meta property="twitter:description" content="This paper looks at mortality during the Spanish flu pandemic of 1918 in 15 districts in the Cape Province of South Africa."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=METHODOLOGICAL NOTE: PREDICTED NUMBERS OF DEATHS BY EPI-WEEK FOR SOUTH AFRICA IN 2020 AND 2021;citation_publication_date=2021;citation_publisher=South African Medical Research Council;citation_author=Rob Dorrington;citation_author=Debbie Bradshaw;citation_author=Ria Laubscher;citation_author=Pam Groenewald;citation_author=Tom Moultrie"/>
  <meta name="citation_reference" content="citation_title=Influenza and pneumonia mortality in 66 large cities in the united states in years surrounding the 1918 pandemic;citation_publication_date=2011;citation_volume=6;citation_author=R. AcuÃ±a-Soto;citation_author=C. Viboud;citation_author=G. Chowell"/>
  <meta name="citation_reference" content="citation_title=Methods for monitoring influenza surveillance data;citation_publication_date=2006;citation_volume=35;citation_doi=10.1093/ije/dyl162;citation_issn=0300-5771;citation_author=Benjamin J Cowling;citation_author=Irene O L Wong;citation_author=Lai-Ming Ho;citation_author=Steven Riley;citation_author=Gabriel M Leung"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Draft: Spanish Flu Mortality"]},{"type":"character","attributes":{},"value":["This paper looks at mortality during the Spanish flu pandemic of 1918 in 15 districts in the Cape Province of South Africa.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Jonathan Jayes"]}]}]},{"type":"character","attributes":{},"value":["07-28-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","code_folding","highlight","highlight_downlit","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["haddock"]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["bibliography.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bibliography.bib","data/birth_place_shares.rds","data/births-by-race.xlsx","data/births_by_town.rds","data/child_mortality.rds","data/infant_mortality.rds","data/influenza_mort.rds","data/pneumonia_infleunza_mort.rds","data/pneumonia_influenza.rds","data/pneumonia_mort.rds","data/spanish_flu_data.rds","data/town_race_mort_rates.rds","spanish-flu-mortality_files/anchor-4.2.2/anchor.min.js","spanish-flu-mortality_files/bowser-1.9.3/bowser.min.js","spanish-flu-mortality_files/distill-2.2.21/template.v2.js","spanish-flu-mortality_files/figure-html5/cradock-paarl-causes-1.png","spanish-flu-mortality_files/figure-html5/seasonality-1.png","spanish-flu-mortality_files/figure-html5/town-density-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-10-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-11-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-12-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-13-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-15-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-16-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-17-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-18-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-19-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-2-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-20-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-21-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-22-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-23-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-3-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-4-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-5-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-8-1.png","spanish-flu-mortality_files/figure-html5/unnamed-chunk-9-1.png","spanish-flu-mortality_files/figure-html5/viridis-deaths-1.png","spanish-flu-mortality_files/header-attrs-2.9/header-attrs.js","spanish-flu-mortality_files/jquery-1.11.3/jquery.min.js","spanish-flu-mortality_files/popper-2.6.0/popper.min.js","spanish-flu-mortality_files/tippy-6.2.7/tippy-bundle.umd.min.js","spanish-flu-mortality_files/tippy-6.2.7/tippy-light-border.css","spanish-flu-mortality_files/tippy-6.2.7/tippy.css","spanish-flu-mortality_files/tippy-6.2.7/tippy.umd.min.js","spanish-flu-mortality_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="spanish-flu-mortality_files/header-attrs-2.9/header-attrs.js"></script>
  <script src="spanish-flu-mortality_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="spanish-flu-mortality_files/popper-2.6.0/popper.min.js"></script>
  <link href="spanish-flu-mortality_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="spanish-flu-mortality_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="spanish-flu-mortality_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="spanish-flu-mortality_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="spanish-flu-mortality_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="spanish-flu-mortality_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="spanish-flu-mortality_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Draft: Spanish Flu Mortality","description":"This paper looks at mortality during the Spanish flu pandemic of 1918 in 15 districts in the Cape Province of South Africa.","authors":[{"author":"Jonathan Jayes","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-07-28T00:00:00.000+02:00","citationText":"Jayes, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Draft: Spanish Flu Mortality</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>This paper looks at mortality during the Spanish flu pandemic of 1918 in 15 districts in the Cape Province of South Africa.</p></p>
</div>

<div class="d-byline">
  Jonathan Jayes  
  
<br/>07-28-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#the-1918-spanish-flu-pandemic-in-south-africa-assesing-mortality">The 1918 Spanish flu pandemic in South Africa: assesing mortality</a>
<ul>
<li><a href="#abstract">Abstract</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#historical-background">Historical background</a></li>
<li><a href="#findings-in-other-literature">Findings in other literature</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#how-many-died-during-the-pandemic">How many died during the pandemic?</a>
<ul>
<li><a href="#what-were-the-mortality-rates-in-each-district">What were the mortality rates in each district?</a></li>
<li><a href="#conclusion-of-excess-mortalty-calculations-is-to-use-all-respiratory-deaths-during-pandemic-as-pandemic-deaths---more-reliable-than-lsicing-data-in-preceding-years-thinly---due-to-data-coarsity.">Conclusion of excess mortalty calculations is to use all respiratory deaths during pandemic as pandemic deaths - more reliable than lsicing data in preceding years thinly - due to data coarsity.</a></li>
</ul></li>
<li><a href="#correlates">Correlates</a>
<ul>
<li><a href="#pre-existing-health">Pre-existing health</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="the-1918-spanish-flu-pandemic-in-south-africa-assesing-mortality">The 1918 Spanish flu pandemic in South Africa: assesing mortality</h1>
<h2 id="abstract">Abstract</h2>
<p>This paper looks at mortality during the Spanish flu pandemic of 1918 in 15 districts in the Cape Province of South Africa.</p>
<p>40,000 death notices.</p>
<h2 id="introduction">Introduction</h2>
<p>I assess excess mortality using three different methods to quantify how many people died in each district.</p>
<p>Then I look at three measures of pre-pandemic health and how these correlate with excess mortality.</p>
<h2 id="historical-background">Historical background</h2>
<h4 id="importance-of-initial-exposure">Importance of initial exposure</h4>
<h2 id="findings-in-other-literature">Findings in other literature</h2>
<h2 id="data">Data</h2>
<p>Forms of Information of a Death. As of Act No. 7 of 1894 of the Cape Colony.</p>
<p>“N.B. – If the certificate of a Medical Practitioner is produced, the causes of Death and Duration of Illness must be recorded in the Registration Book by the Deputy Registrar and Assistant to the Deputy Registrar as stated in such Certificate, which is to be attached to the form.”</p>
<h2 id="how-many-died-during-the-pandemic">How many died during the pandemic?</h2>
<p>Figure <a href="#fig:viridis-deaths">1</a> shows a heatmap of the deaths.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>between</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1915-01-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1920-12-30"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>death_date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/round_date.html'>floor_date</a></span><span class='op'>(</span><span class='va'>death_date</span>, unit <span class='op'>=</span> <span class='st'>"week"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"town"</span>, values_from <span class='op'>=</span> <span class='st'>"n"</span>, values_fill <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='va'>death_date</span>, names_to <span class='op'>=</span> <span class='st'>"town"</span>, values_to <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>town <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='va'>town</span>, fill <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_tile</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_fill_viridis_c</span><span class='op'>(</span>trans <span class='op'>=</span> <span class='st'>"sqrt"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='cn'>NULL</span>,
    y <span class='op'>=</span> <span class='cn'>NULL</span>,
    fill <span class='op'>=</span> <span class='st'>"Number of deaths per week"</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>guides</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='fu'>guide_colourbar</span><span class='op'>(</span>
    barwidth <span class='op'>=</span> <span class='fl'>30</span>, barheight <span class='op'>=</span> <span class='fl'>.5</span>,
    title.position <span class='op'>=</span> <span class='st'>"top"</span>,
    title.hjust <span class='op'>=</span> <span class='fl'>.5</span>
  <span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span id="fig:viridis-deaths"></span>
<img src="spanish-flu-mortality_files/figure-html5/viridis-deaths-1.png" alt="Heatmap of deaths per week" width="768" />
<p class="caption">
Figure 1: Heatmap of deaths per week
</p>
</div>
</div>
<p>There is considerable variation in the crude death rate by district over time, as shown in Figure <a href="#fig:town-density">2</a>. Here we can see two important features of the pandemic in our sample of Cape districts. First, the pandemic arrived in different districts at different times. In districts close to Cape Town, where the soldiers arrived soon after they were released from quarantine at port.</p>
<p>[Cite Philips here with the history of the arrival of the ships from Freetown]</p>
<aside>
Crude death rate is the total number of deaths during a given time interval divided by the population.
</aside>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>between</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-12-30"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>death_date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/round_date.html'>floor_date</a></span><span class='op'>(</span><span class='va'>death_date</span>, unit <span class='op'>=</span> <span class='st'>"days"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"town"</span>, values_from <span class='op'>=</span> <span class='st'>"n"</span>, values_fill <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='va'>death_date</span>, names_to <span class='op'>=</span> <span class='st'>"town"</span>, values_to <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>df</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>between</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1919-08-30"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>death_date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/round_date.html'>floor_date</a></span><span class='op'>(</span><span class='va'>death_date</span>, unit <span class='op'>=</span> <span class='st'>"3 days"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>count</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>slice_max</span><span class='op'>(</span><span class='va'>n</span>, n <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>death_date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>select</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>row_num <span class='op'>=</span> <span class='fu'>row_number</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>town <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>row_num</span>, .desc <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>death_date</span>, y <span class='op'>=</span> <span class='va'>town</span>, height <span class='op'>=</span> <span class='va'>n</span>, fill <span class='op'>=</span> <span class='va'>town</span>, group <span class='op'>=</span> <span class='va'>town</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/ggridges/reference/geom_density_ridges.html'>geom_density_ridges</a></span><span class='op'>(</span>
    stat <span class='op'>=</span> <span class='st'>"identity"</span>, show.legend <span class='op'>=</span> <span class='cn'>F</span>,
    alpha <span class='op'>=</span> <span class='fl'>.8</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_fill_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='st'>"Zissou1"</span>, <span class='fl'>15</span>, type <span class='op'>=</span> <span class='st'>"continuous"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='st'>"Date of death"</span>,
    y <span class='op'>=</span> <span class='cn'>NULL</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span id="fig:town-density"></span>
<img src="spanish-flu-mortality_files/figure-html5/town-density-1.png" alt="Ridge plot of number of deaths in district by date" width="768" />
<p class="caption">
Figure 2: Ridge plot of number of deaths in district by date
</p>
</div>
</div>
<h3 id="what-were-the-mortality-rates-in-each-district">What were the mortality rates in each district?</h3>
<h4 id="candidate-methods-for-assessing-excess-mortality.">Candidate methods for assessing (excess) mortality.</h4>
<p>A great benefit of the dataset at hand is the recording of a cause of death on the notice. This was either copied from the Certificate of the Medical Practitioner, or in the absence of such a certificate, told to the registrar by the informant. Hence, the most intuitive method to assess how many people died in each district of the Spanish flu is simply to count the number of deaths recorded with “Spanish flu” listed in the cause of death column. However, there are a number of drawbacks to this method.</p>
<ul>
<li>Doctors and families who reported to the registrar the cause of death may not have known that the deaths at the beginning of the pandemic were due to the Spanish flu as news of the disease likely travelled across the country slower than the disease itself.</li>
<li>There is likely some selection into the provision of a cause of death by location within a district. The Form of Information of a Death states that “Medical Certificates are essential in Urban Areas,” while in “Rural Areas Informants can report in <strong>three</strong> ways – one being under declaration” (find correct citation for death notice).</li>
<li>There are discrepancies in the reporting of the disease by district. Contrast for instance the labelling of deaths in Cradock and Paarl. In the top facet of Figure <a href="#fig:cradock-paarl-causes">3</a>, it is evident that the vast majority of deaths during the pandemic are labelled as Spanish flu deaths. In contrast, fewer than half of the deaths that occurred during the pandemic are labelled as Spanish flu deaths in Paarl.</li>
<li>To avoid this complication is is tempting to simply count the number of deaths in each district during the pandemic period and conclude that these were caused by the flu. However, districts of different population sizes would have expected different numbers of deaths in the absence of the pandemic. Hence it is not advisable to conclude that all recorded deaths were due to the flu.</li>
</ul>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>between</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1919-01-01"</span><span class='op'>)</span><span class='op'>)</span>,
         <span class='va'>town</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Cradock"</span>, <span class='st'>"Paarl"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>death_date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/round_date.html'>floor_date</a></span><span class='op'>(</span><span class='va'>death_date</span>, unit <span class='op'>=</span> <span class='st'>"week"</span><span class='op'>)</span>,
         causes_of_death <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>causes_of_death</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>spanish <span class='op'>=</span> <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>causes_of_death</span>, <span class='st'>"spanish"</span><span class='op'>)</span>,
         spanish <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>spanish</span> <span class='op'>==</span> <span class='cn'>TRUE</span>, <span class='st'>"Cause of death labelled 'Spanish flu'"</span>, <span class='st'>"Other cause of death"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>count</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='va'>spanish</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"spanish"</span>, values_from <span class='op'>=</span> <span class='st'>"n"</span>, values_fill <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>death_date</span>, <span class='va'>town</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>name</span> <span class='op'>!=</span> <span class='st'>"NA"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='va'>value</span>, fill <span class='op'>=</span> <span class='va'>name</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_area</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>scale_fill_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='st'>"Zissou1"</span>, <span class='fl'>2</span>, type <span class='op'>=</span> <span class='st'>"continuous"</span><span class='op'>)</span>,
                      guide <span class='op'>=</span> <span class='fu'>guide_legend</span><span class='op'>(</span>reverse <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>town</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='cn'>NULL</span>, 
       y <span class='op'>=</span> <span class='st'>"Number of deaths per week"</span>,
       fill <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span id="fig:cradock-paarl-causes"></span>
<img src="spanish-flu-mortality_files/figure-html5/cradock-paarl-causes-1.png" alt="Density plot comparing causes of death during the pandemic in Cradock and Paarl" width="768" />
<p class="caption">
Figure 3: Density plot comparing causes of death during the pandemic in Cradock and Paarl
</p>
</div>
</div>
<p>Table <a href="#tab:cradock-paarl-causes-tab">1</a> evidences that the majority of deaths in Paarl were labelled simply as “Influenza.”</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span>
    <span class='fu'>between</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1919-01-01"</span><span class='op'>)</span><span class='op'>)</span>,
    <span class='va'>town</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Cradock"</span>, <span class='st'>"Paarl"</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>causes_of_death</span>, <span class='va'>town</span>, sort <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>slice_max</span><span class='op'>(</span><span class='va'>n</span>, n <span class='op'>=</span> <span class='fl'>12</span>, with_ties <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span>Cradock <span class='op'>=</span> <span class='va'>causes_of_death</span>, n_cradock <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>bind_cols</span><span class='op'>(</span><span class='va'>df</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span>
      <span class='fu'>between</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1919-01-01"</span><span class='op'>)</span><span class='op'>)</span>,
      <span class='va'>town</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Cradock"</span>, <span class='st'>"Paarl"</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>count</span><span class='op'>(</span><span class='va'>causes_of_death</span>, <span class='va'>town</span>, sort <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>slice_max</span><span class='op'>(</span><span class='va'>n</span>, n <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>select</span><span class='op'>(</span>Paarl <span class='op'>=</span> <span class='va'>causes_of_death</span>, n_paarl <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>caption <span class='op'>=</span> <span class='st'>"Comparison of common causes of death in Cradock and Paarl during the pandemic"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<caption><span id="tab:cradock-paarl-causes-tab">Table 1: </span>Comparison of common causes of death in Cradock and Paarl during the pandemic</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Cradock</th>
<th style="text-align: right;">n_cradock</th>
<th style="text-align: left;">Paarl</th>
<th style="text-align: right;">n_paarl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Spanish Influenza</td>
<td style="text-align: right;">444</td>
<td style="text-align: left;">Influenza</td>
<td style="text-align: right;">367</td>
</tr>
<tr class="even">
<td style="text-align: left;">Flu</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">Spanish Influenza</td>
<td style="text-align: right;">247</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Influenza</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">Pneumonia</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bronchitis</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">Spanish Influenza, Pneumonia</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Broncho Pneumonia</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Convulsions</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Convulsions</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Spaanse Griep</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Teething</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Spanish Influenza (Pneumonia)</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diarrhoea</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Bronchitis</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Old age</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Broncho Pneumonia</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Consumption</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Gastro Enteritis</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inflammation of lungs</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Spanish Flu</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pneumonia</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">A) Spanish Influenza B) Pneumonia</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
<p>An alternate set of methods for quantifying excess mortality use history as a guide for the number of deaths that we can expect to occur in each district. These use the mortality figures for three years preceding the pandemic as a guide, looking at the average number of deaths in each district during the pandemic peak (October, November and December), taking an average of the whole year mortality in each district, and creating regression models with the historical data to predict the expected number of deaths in the pandemic period. I explain each below.</p>
<p>First, making use of the death notices from 1915 to 1917 and following the methodology laid out by the South Africa Medical Research Council in <span class="citation" data-cites="Dorrington2021"><a href="#ref-Dorrington2021" role="doc-biblioref">Dorrington et al.</a> (<a href="#ref-Dorrington2021" role="doc-biblioref">2021</a>)</span>, I calculate the average number of deaths per month in each town during the pandemic period in the three preceding years as a baseline. The SAMRC define excess mortality is calculated as “the number of all-cause deaths in the last week less the number that might have been expected to have occurred” <span class="citation" data-cites="Dorrington2021">(<a href="#ref-Dorrington2021" role="doc-biblioref">Dorrington et al. 2021, 2</a>)</span>.</p>
<p>I then subtract this expected number of deaths from the observed number during the pandemic to calculate excess mortality.</p>
<p>The advantage of this method is that it captures the seasonal variation in</p>
<p>Problems: data too coarse to get reasonable estimates at district-week level. aggregate to district-month level.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>sf_indicator</span> <span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>mutate</span><span class='op'>(</span>death_date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/round_date.html'>floor_date</a></span><span class='op'>(</span><span class='va'>death_date</span>, <span class='st'>"week"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>count</span><span class='op'>(</span><span class='va'>death_date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>mutate</span><span class='op'>(</span>year <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>death_date</span><span class='op'>)</span>,
           week <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/week.html'>week</a></span><span class='op'>(</span><span class='va'>death_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>year</span> <span class='op'>!=</span> <span class='fl'>1918</span>,
           <span class='va'>year</span> <span class='op'>&gt;</span> <span class='fl'>1914</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>week</span>, <span class='va'>n</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>year</span><span class='op'>)</span>, group <span class='op'>=</span> <span class='va'>year</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_vline</span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>40</span>, <span class='fl'>44</span><span class='op'>)</span>, lty <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>group <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>expand_limits</span><span class='op'>(</span>y <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='fl'>5</span>, name <span class='op'>=</span> <span class='st'>"Zissou1"</span>, type <span class='op'>=</span> <span class='st'>"continuous"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Week of the year"</span>,
         y <span class='op'>=</span> <span class='st'>"Number of deaths per week"</span>,
         colour <span class='op'>=</span> <span class='st'>"Year"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span id="fig:seasonality"></span>
<img src="spanish-flu-mortality_files/figure-html5/seasonality-1.png" alt="Mortality by week across districts - excluding 1918" width="768" />
<p class="caption">
Figure 4: Mortality by week across districts - excluding 1918
</p>
</div>
</div>
<p>Second, I calculate a simple average of the number of deaths per year in each district in the three prior years. Table <a href="#tab:mean-mortality-by-district-tab">2</a> shows the mortality by district from 1915 to 1917, and the average across these three years.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>death_date</span> <span class='op'>&lt;</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-01-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>year <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>death_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>year</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>average <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"year"</span>, values_from <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>average</span>, .after <span class='op'>=</span> <span class='va'>`1917`</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='op'>-</span><span class='va'>town</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>average</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>caption <span class='op'>=</span> <span class='st'>"Mortality by district in years preceding pandemic"</span>,
               col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"District"</span>, <span class='st'>"1915"</span>, <span class='st'>"1916"</span>, <span class='st'>"1917"</span>, <span class='st'>"Average"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<caption><span id="tab:mean-mortality-by-district-tab">Table 2: </span>Mortality by district in years preceding pandemic</caption>
<thead>
<tr class="header">
<th style="text-align: left;">District</th>
<th style="text-align: right;">1915</th>
<th style="text-align: right;">1916</th>
<th style="text-align: right;">1917</th>
<th style="text-align: right;">Average</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Queenstown</td>
<td style="text-align: right;">843</td>
<td style="text-align: right;">1083</td>
<td style="text-align: right;">849</td>
<td style="text-align: right;">925</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oudtshoorn</td>
<td style="text-align: right;">816</td>
<td style="text-align: right;">768</td>
<td style="text-align: right;">1019</td>
<td style="text-align: right;">868</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Paarl</td>
<td style="text-align: right;">731</td>
<td style="text-align: right;">715</td>
<td style="text-align: right;">755</td>
<td style="text-align: right;">734</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stellenbosch</td>
<td style="text-align: right;">503</td>
<td style="text-align: right;">556</td>
<td style="text-align: right;">604</td>
<td style="text-align: right;">554</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cradock</td>
<td style="text-align: right;">378</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">382</td>
<td style="text-align: right;">387</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mafeking</td>
<td style="text-align: right;">344</td>
<td style="text-align: right;">382</td>
<td style="text-align: right;">344</td>
<td style="text-align: right;">357</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stockenstrom</td>
<td style="text-align: right;">264</td>
<td style="text-align: right;">331</td>
<td style="text-align: right;">335</td>
<td style="text-align: right;">310</td>
</tr>
<tr class="even">
<td style="text-align: left;">Komga</td>
<td style="text-align: right;">241</td>
<td style="text-align: right;">338</td>
<td style="text-align: right;">301</td>
<td style="text-align: right;">293</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Peddie</td>
<td style="text-align: right;">266</td>
<td style="text-align: right;">264</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">267</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fraserburg</td>
<td style="text-align: right;">244</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">222</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kuruman</td>
<td style="text-align: right;">182</td>
<td style="text-align: right;">247</td>
<td style="text-align: right;">194</td>
<td style="text-align: right;">208</td>
</tr>
<tr class="even">
<td style="text-align: left;">Riversdale</td>
<td style="text-align: right;">199</td>
<td style="text-align: right;">203</td>
<td style="text-align: right;">204</td>
<td style="text-align: right;">202</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vryburg</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">214</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="even">
<td style="text-align: left;">Elliot</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">115</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sea Point</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">44</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>year <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>death_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>year</span> <span class='op'>==</span> <span class='fl'>1918</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>rename</span><span class='op'>(</span>deaths_1918 <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span>
    <span class='va'>df</span> <span class='op'>%&gt;%</span>
      <span class='fu'>mutate</span><span class='op'>(</span>year <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>death_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>count</span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>year</span> <span class='op'>&lt;=</span> <span class='fl'>1917</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>summarise</span><span class='op'>(</span>avg_deaths_1915_1917 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>year</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>town <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>deaths_1918</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='va'>town</span>, names_to <span class='op'>=</span> <span class='st'>"type"</span>, values_to <span class='op'>=</span> <span class='st'>"deaths"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>type</span>, <span class='st'>"deaths_1918"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Mortality in 1918"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Mean motality between 1915 and 1917"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>deaths</span>, <span class='va'>town</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>town</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>type</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>number_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    colour <span class='op'>=</span> <span class='cn'>NULL</span>,
    caption <span class='op'>=</span> <span class='st'>"Length of line represents absolute excess mortality"</span>,
    y <span class='op'>=</span> <span class='cn'>NULL</span>,
    x <span class='op'>=</span> <span class='st'>"Mortality"</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-2-1.png" width="624" /></p>
</div>
<p>Third, I use regression models to extrapolate the mortality we would expect in each district if the historical trends from 1915 to 1917 continued.</p>
<p>I use three regression models. These are linear model with only an intercept - in effect the same as the averaging procedure from above, but over a shorter window. Specifically, I average the number of deaths in the three month period including October, November and December in the three years prior to 1918 as a guide for the average number of deaths per district. This accounts for the seasonality shown in Figure <a href="#fig:seasonality">4</a>, whereby there are a greater number of deaths in the second half of the year.</p>
<p>Next I use a simple linear regression. This accounts, for instance, for population growth and consequent linear increases in the number of registered deaths per district per year.</p>
<aside>
<p>The linear trend is shown in the figure here:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/slowkow/ggrepel'>ggrepel</a></span><span class='op'>)</span>
<span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>year <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>death_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>year</span> <span class='op'>&lt;=</span> <span class='fl'>1917</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>nest</span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>lm_fit <span class='op'>=</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>data</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>~</span> <span class='va'>year</span>, data <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span>
    <span class='va'>df</span> <span class='op'>%&gt;%</span>
      <span class='fu'>mutate</span><span class='op'>(</span>year <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>death_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>count</span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>year</span> <span class='op'>&gt;</span> <span class='fl'>1917</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>nest</span><span class='op'>(</span>post_data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>n</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>augmented <span class='op'>=</span> <span class='fu'>map2</span><span class='op'>(</span><span class='va'>lm_fit</span>, <span class='va'>post_data</span>, <span class='op'>~</span> <span class='fu'><a href='https://generics.r-lib.org/reference/augment.html'>augment</a></span><span class='op'>(</span><span class='va'>.x</span>, newdata <span class='op'>=</span> <span class='va'>.y</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>augmented</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>year</span> <span class='op'>==</span> <span class='fl'>1918</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>.fitted</span>, <span class='va'>n</span>, label <span class='op'>=</span> <span class='fu'>str_to_title</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_abline</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, se <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='st'>"Predicted 1918 mortality based on linear trend"</span>,
    y <span class='op'>=</span> <span class='st'>"Actual 1918 mortality"</span>
  <span class='op'>)</span> 
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
</div>
</aside>
<p>Further I use a regression model from Serfling that accounts for the seasonality of respiratory diseases like flu and influenza. “Serfling’s method uses cyclic regression to model the weekly proportion of deaths from pneumonia and influenza and to define an epidemic threshold that is adjusted for seasonal effects.” <span class="citation" data-cites="Cowling2006">(<a href="#ref-Cowling2006" role="doc-biblioref">Cowling et al. 2006, 4</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_reg</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/round_date.html'>floor_date</a></span><span class='op'>(</span><span class='va'>death_date</span>, <span class='st'>"week"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-01-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>nest</span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>
    lm_fit <span class='op'>=</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>data</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>~</span> <span class='va'>date</span>, data <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span>,
    q_fit <span class='op'>=</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>data</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/poly.html'>poly</a></span><span class='op'>(</span><span class='va'>date</span>, <span class='fl'>2</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span>
    <span class='va'>df</span> <span class='op'>%&gt;%</span>
      <span class='fu'>mutate</span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/round_date.html'>floor_date</a></span><span class='op'>(</span><span class='va'>death_date</span>, <span class='st'>"week"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>count</span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-01-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>nest</span><span class='op'>(</span>post_data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>n</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>
    augmented_lm <span class='op'>=</span> <span class='fu'>map2</span><span class='op'>(</span><span class='va'>lm_fit</span>, <span class='va'>post_data</span>, <span class='op'>~</span> <span class='fu'><a href='https://generics.r-lib.org/reference/augment.html'>augment</a></span><span class='op'>(</span><span class='va'>.x</span>, newdata <span class='op'>=</span> <span class='va'>.y</span><span class='op'>)</span><span class='op'>)</span>,
    augmented_q <span class='op'>=</span> <span class='fu'>map2</span><span class='op'>(</span><span class='va'>q_fit</span>, <span class='va'>post_data</span>, <span class='op'>~</span> <span class='fu'><a href='https://generics.r-lib.org/reference/augment.html'>augment</a></span><span class='op'>(</span><span class='va'>.x</span>, newdata <span class='op'>=</span> <span class='va'>.y</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>augmented_lm</span>, <span class='va'>augmented_q</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>between</span><span class='op'>(</span><span class='va'>date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-01-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-12-31"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>date</span>, <span class='va'>n</span>, <span class='va'>.fitted</span>, <span class='va'>.fitted1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>rename</span><span class='op'>(</span>
    linear_trend <span class='op'>=</span> <span class='va'>.fitted</span>,
    seasonal_trend <span class='op'>=</span> <span class='va'>.fitted1</span>,
    observed <span class='op'>=</span> <span class='va'>n</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='va'>observed</span><span class='op'>:</span><span class='va'>seasonal_trend</span>, .fns <span class='op'>=</span> <span class='va'>sum</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>observed</span>, <span class='va'>linear_trend</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>df</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>mutate</span><span class='op'>(</span>death_date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/round_date.html'>floor_date</a></span><span class='op'>(</span><span class='va'>death_date</span>, <span class='st'>"month"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>count</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>death_date</span> <span class='op'>&lt;</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>summarise</span><span class='op'>(</span>mean_deaths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>,
              n <span class='op'>=</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>mean_deaths <span class='op'>=</span> <span class='fl'>12</span> <span class='op'>*</span> <span class='va'>mean_deaths</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>between</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1915-10-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1915-12-31"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>n_1915 <span class='op'>=</span> <span class='va'>n</span><span class='op'>*</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>df</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>between</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1916-10-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1916-12-31"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>n_1916 <span class='op'>=</span> <span class='va'>n</span><span class='op'>*</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>df</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>between</span><span class='op'>(</span><span class='va'>death_date</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1917-10-01"</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1917-12-31"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>n_1917 <span class='op'>=</span> <span class='va'>n</span><span class='op'>*</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='va'>value</span>, .fns <span class='op'>=</span> <span class='va'>mean</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>value</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>rename</span><span class='op'>(</span>mean_deaths_oct_dec <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>town <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>observed</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>observed</span><span class='op'>)</span>, names_to <span class='op'>=</span> <span class='st'>"type"</span>, values_to <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>type</span>, <span class='st'>"linear"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Linear trend in deaths per month"</span>,
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>type</span>, <span class='st'>"mean_deaths_oct_dec"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Average number of deaths per month (Oct-Dec)"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Average number of deaths per month"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>mean_projected_deaths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>


<span class='va'>df_reg</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>town</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>town</span>, colour <span class='op'>=</span> <span class='st'>"Estimate range from regression models"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>observed</span>, <span class='va'>town</span>, shape <span class='op'>=</span> <span class='st'>"Observed pandemic mortality"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>mean_projected_deaths</span>, <span class='va'>town</span>, shape <span class='op'>=</span> <span class='st'>"Mean projected mortality"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_color_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='st'>"grey50"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>guides</span><span class='op'>(</span>color <span class='op'>=</span> <span class='fu'>guide_legend</span><span class='op'>(</span>order <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
         shape <span class='op'>=</span> <span class='fu'>guide_legend</span><span class='op'>(</span>order <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='st'>"Mortality"</span>,
    colour <span class='op'>=</span> <span class='cn'>NULL</span>,
    shape <span class='op'>=</span> <span class='cn'>NULL</span>,
    y <span class='op'>=</span> <span class='cn'>NULL</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_reg</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>observed</span>, <span class='va'>mean_projected_deaths</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>excess_mortality <span class='op'>=</span> <span class='va'>observed</span> <span class='op'>-</span> <span class='va'>mean_projected_deaths</span>,
         <span class='fu'>across</span><span class='op'>(</span><span class='fu'>where</span><span class='op'>(</span><span class='va'>is.numeric</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='va'>round</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>excess_mortality</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># mutate(across(where(is.numeric), .fns = ~ number_format(.x, ))) %&gt;% </span>
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"District"</span>, <span class='st'>"Observed"</span>, <span class='st'>"Projected"</span>, <span class='st'>"Excess"</span><span class='op'>)</span>,
               caption <span class='op'>=</span> <span class='st'>"Observed, predicted and excess mortality based on regression methods"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-5">Table 3: </span>Observed, predicted and excess mortality based on regression methods</caption>
<thead>
<tr class="header">
<th style="text-align: left;">District</th>
<th style="text-align: right;">Observed</th>
<th style="text-align: right;">Projected</th>
<th style="text-align: right;">Excess</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Queenstown</td>
<td style="text-align: right;">1693</td>
<td style="text-align: right;">886</td>
<td style="text-align: right;">807</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paarl</td>
<td style="text-align: right;">1465</td>
<td style="text-align: right;">675</td>
<td style="text-align: right;">790</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Peddie</td>
<td style="text-align: right;">1048</td>
<td style="text-align: right;">259</td>
<td style="text-align: right;">789</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stockenstrom</td>
<td style="text-align: right;">946</td>
<td style="text-align: right;">325</td>
<td style="text-align: right;">621</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stellenbosch</td>
<td style="text-align: right;">1170</td>
<td style="text-align: right;">550</td>
<td style="text-align: right;">620</td>
</tr>
<tr class="even">
<td style="text-align: left;">Komga</td>
<td style="text-align: right;">827</td>
<td style="text-align: right;">283</td>
<td style="text-align: right;">544</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oudtshoorn</td>
<td style="text-align: right;">1410</td>
<td style="text-align: right;">910</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mafeking</td>
<td style="text-align: right;">781</td>
<td style="text-align: right;">332</td>
<td style="text-align: right;">449</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Elliot</td>
<td style="text-align: right;">527</td>
<td style="text-align: right;">112</td>
<td style="text-align: right;">415</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cradock</td>
<td style="text-align: right;">763</td>
<td style="text-align: right;">364</td>
<td style="text-align: right;">399</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vryburg</td>
<td style="text-align: right;">455</td>
<td style="text-align: right;">191</td>
<td style="text-align: right;">264</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kuruman</td>
<td style="text-align: right;">427</td>
<td style="text-align: right;">220</td>
<td style="text-align: right;">207</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fraserburg</td>
<td style="text-align: right;">264</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Riversdale</td>
<td style="text-align: right;">214</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sea Point</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<h3 id="conclusion-of-excess-mortalty-calculations-is-to-use-all-respiratory-deaths-during-pandemic-as-pandemic-deaths---more-reliable-than-lsicing-data-in-preceding-years-thinly---due-to-data-coarsity.">Conclusion of excess mortalty calculations is to use all respiratory deaths during pandemic as pandemic deaths - more reliable than lsicing data in preceding years thinly - due to data coarsity.</h3>
<p>A possible choice at this point would be to classify any death occurring during the pandemic with respiratory disease such as pneumonia or influenza listed in the cause of death as a Spanish flu death. [To be completed: In the appendix I show that this can be done effectively with a machine learning model and a relatively small set of hand-labelled training data.]</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># show figure from presentation that has Phillips numbers compared to our own.</span>
</code></pre>
</div>
</details>
</div>
<h4 id="timing-and-the-absence-of-subsequent-waves">Timing and the absence of subsequent waves</h4>
<p>This speaks to the severity of the pandemic. Caveat, Komgha and Oudtshoorn.</p>
<h2 id="correlates">Correlates</h2>
<h3 id="pre-existing-health">Pre-existing health</h3>
<p>A wealth of literature has shown that there is a strong correlation between the level of health and prevalence of illnesses in different communities and their outcomes facing a pandemic.</p>
<p>I examine two measures of pre-existing health in the 15 districts which constitute the sample. The first uses infant and child mortality statistics as a proxy for the level of existing health and healthcare in a district. The second assess mortality from influenza and pneumonia prior to the pandemic to gauge levels of health in different communities.</p>
<h4 id="pre-pandemic-infant-and-child-mortality-rates">Pre-pandemic infant and child mortality rates</h4>
<p>We start with infant mortality rates. Defined as the share of children below 1 dying each year divided by the number of births each year.</p>
<p>Two sources of data: - infant deaths from our death notices in each district. Taken from 1915 - 1917. - infant births - record from blue books/archive… (CITAION). Multiply the snapshot by three to get an average mortality rate prior to the pandemic and make the most of the data at our disposal.</p>
<p>Infant mortality: deaths of those below children born in each town.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>births_by_town</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"data/births_by_town.rds"</span><span class='op'>)</span>

<span class='va'>df_infant</span> <span class='op'>&lt;-</span> <span class='va'>births_by_town</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>total</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='va'>town</span>, names_to <span class='op'>=</span> <span class='st'>"race"</span>, values_to <span class='op'>=</span> <span class='st'>"births"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>race <span class='op'>=</span> <span class='fu'>str_to_title</span><span class='op'>(</span><span class='va'>race</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>births <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>births</span> <span class='op'>==</span> <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='va'>births</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># for the three years</span>
  <span class='fu'>mutate</span><span class='op'>(</span>births <span class='op'>=</span> <span class='fl'>3</span><span class='op'>*</span><span class='va'>births</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>df</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span>
      <span class='va'>death_date</span> <span class='op'>&lt;</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-01-01"</span><span class='op'>)</span>,
      <span class='va'>age_years</span> <span class='op'>&lt;=</span> <span class='fl'>1</span>,
      <span class='va'>race</span> <span class='op'>!=</span> <span class='st'>"NA"</span>
    <span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>count</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>race</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>rename</span><span class='op'>(</span>deaths <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"town"</span>, <span class='st'>"race"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>infant_mort_rate <span class='op'>=</span> <span class='va'>deaths</span><span class='op'>/</span><span class='va'>births</span>,
         low <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Beta.html'>qbeta</a></span><span class='op'>(</span><span class='fl'>.025</span>, <span class='va'>deaths</span> <span class='op'>+</span> <span class='fl'>.5</span>, <span class='va'>births</span> <span class='op'>-</span> <span class='va'>deaths</span> <span class='op'>+</span> <span class='fl'>.5</span><span class='op'>)</span>,
         high <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Beta.html'>qbeta</a></span><span class='op'>(</span><span class='fl'>.975</span>, <span class='va'>deaths</span> <span class='op'>+</span> <span class='fl'>.5</span>, <span class='va'>births</span> <span class='op'>-</span> <span class='va'>deaths</span> <span class='op'>+</span> <span class='fl'>.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>births</span> <span class='op'>&gt;</span> <span class='fl'>5</span><span class='op'>)</span>

<span class='va'>df_infant</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>births_grouped <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>births</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,
         deaths_grouped <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>deaths</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>infant_mort_rate_grouped <span class='op'>=</span> <span class='va'>deaths_grouped</span> <span class='op'>/</span> <span class='va'>births_grouped</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>race</span>, <span class='va'>infant_mort_rate</span>, <span class='va'>infant_mort_rate_grouped</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"race"</span>, values_from <span class='op'>=</span> <span class='st'>"infant_mort_rate"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'>where</span><span class='op'>(</span><span class='va'>is.numeric</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='op'>~</span> <span class='va'>.x</span><span class='op'>*</span><span class='fl'>1000</span><span class='op'>)</span>,
         <span class='fu'>across</span><span class='op'>(</span><span class='fu'>where</span><span class='op'>(</span><span class='va'>is.numeric</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='va'>round</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>infant_mort_rate_grouped</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"District"</span>, <span class='st'>"Aggregate"</span>, <span class='st'>"White"</span>, <span class='st'>"Black"</span>, <span class='st'>"Coloured"</span><span class='op'>)</span>,
               caption <span class='op'>=</span> <span class='st'>"Infant mortality by race"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-7">Table 4: </span>Infant mortality by race</caption>
<thead>
<tr class="header">
<th style="text-align: left;">District</th>
<th style="text-align: right;">Aggregate</th>
<th style="text-align: right;">White</th>
<th style="text-align: right;">Black</th>
<th style="text-align: right;">Coloured</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Stockenstrom</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">448</td>
<td style="text-align: right;">221</td>
</tr>
<tr class="even">
<td style="text-align: left;">Queenstown</td>
<td style="text-align: right;">313</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">425</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cradock</td>
<td style="text-align: right;">286</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">450</td>
<td style="text-align: right;">320</td>
</tr>
<tr class="even">
<td style="text-align: left;">Elliot</td>
<td style="text-align: right;">257</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">574</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oudtshoorn</td>
<td style="text-align: right;">225</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">320</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stellenbosch</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">111</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">243</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Paarl</td>
<td style="text-align: right;">203</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mafeking</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">223</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fraserburg</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">293</td>
</tr>
<tr class="even">
<td style="text-align: left;">Komga</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Riversdale</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">220</td>
</tr>
<tr class="even">
<td style="text-align: left;">Peddie</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kuruman</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">165</td>
<td style="text-align: right;">204</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vryburg</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sea Point</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">52</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_infant</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>town <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/reorder_within.html'>reorder_within</a></span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>infant_mort_rate</span>, <span class='va'>race</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>infant_mort_rate</span>, <span class='va'>town</span>, colour <span class='op'>=</span> <span class='va'>race</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_errorbarh</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='va'>low</span>, xmax <span class='op'>=</span> <span class='va'>high</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/reorder_within.html'>scale_y_reordered</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_color_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='fl'>3</span>, name <span class='op'>=</span> <span class='st'>"Zissou1"</span>, type <span class='op'>=</span> <span class='st'>"continuous"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>race</span>, nrow <span class='op'>=</span> <span class='fl'>3</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Infant mortality per 1000 recorded births"</span>,
       y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<p>Now we know what the pre-existing infant mortality data looked like, we can examine how it was correlated with the pandemic mortality.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infant_mortality</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"data/infant_mortality.rds"</span><span class='op'>)</span>

<span class='va'>infant_mortality</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>births</span> <span class='op'>&gt;</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>infant_mort_rate</span>, <span class='va'>mort_rate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>size <span class='op'>=</span> <span class='va'>total</span>, colour <span class='op'>=</span> <span class='va'>race</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, se <span class='op'>=</span> <span class='cn'>F</span>, <span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"Both groups"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>race</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"lm"</span>, se <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_color_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='fl'>3</span>, name <span class='op'>=</span> <span class='st'>"Zissou1"</span>, type <span class='op'>=</span> <span class='st'>"continuous"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Child mortality rate"</span>,
       y <span class='op'>=</span> <span class='st'>"Pandemic mortality rate"</span>,
       size <span class='op'>=</span> <span class='st'>"District population"</span>,
       colour <span class='op'>=</span> <span class='st'>"Race group"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p>[Conclude here]</p>
<h5 id="child-mortality">Child mortality</h5>
<p>Child mortality as a measure of pre-existing health in the different districts.</p>
<ul>
<li>Defined as the number of deaths in our death notice dataset, divided by the number of children below 5 years of age from census data. The denominator for white individuals is from the 1918 census, while for Black and Coloured individuals is from the 1911 census.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>child_mortality</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"data/child_mortality.rds"</span><span class='op'>)</span>

<span class='va'>child_mortality</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>town <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/reorder_within.html'>reorder_within</a></span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>child_mort_rate</span>, <span class='va'>race</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>child_mort_rate</span>, <span class='va'>town</span>, colour <span class='op'>=</span> <span class='va'>race</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_errorbarh</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='va'>low</span>, xmax <span class='op'>=</span> <span class='va'>high</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/reorder_within.html'>scale_y_reordered</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>race</span>, nrow <span class='op'>=</span> <span class='fl'>2</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_color_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='fl'>2</span>, name <span class='op'>=</span> <span class='st'>"Zissou1"</span>, type <span class='op'>=</span> <span class='st'>"continuous"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Child mortality per 1000 children"</span>,
       y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>child_mortality</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>n_under_5_t <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>n_under_5</span><span class='op'>)</span>,
         deaths_t <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>deaths</span><span class='op'>)</span>,
         child_mort_rate_t <span class='op'>=</span><span class='va'>deaths_t</span> <span class='op'>/</span> <span class='va'>n_under_5_t</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>race</span>, <span class='va'>child_mort_rate</span>, <span class='va'>child_mort_rate_t</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"race"</span>, values_from <span class='op'>=</span> <span class='st'>"child_mort_rate"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'>where</span><span class='op'>(</span><span class='va'>is.numeric</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>.x</span> <span class='op'>*</span> <span class='fl'>1000</span>, digits <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>child_mort_rate_t</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"District"</span>, <span class='st'>"Aggregate"</span>, <span class='st'>"White"</span>, <span class='st'>"Black and Coloured"</span><span class='op'>)</span>,
               caption <span class='op'>=</span> <span class='st'>"Child mortality per 1000 recorded births"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-11">Table 5: </span>Child mortality per 1000 recorded births</caption>
<thead>
<tr class="header">
<th style="text-align: left;">District</th>
<th style="text-align: right;">Aggregate</th>
<th style="text-align: right;">White</th>
<th style="text-align: right;">Black and Coloured</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Vryburg</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">65</td>
</tr>
<tr class="even">
<td style="text-align: left;">Peddie</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kuruman</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Elliot</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">159</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mafeking</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">117</td>
</tr>
<tr class="even">
<td style="text-align: left;">Riversdale</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">215</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Komga</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">174</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fraserburg</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">291</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cradock</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">232</td>
</tr>
<tr class="even">
<td style="text-align: left;">Queenstown</td>
<td style="text-align: right;">216</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">247</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oudtshoorn</td>
<td style="text-align: right;">243</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">391</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paarl</td>
<td style="text-align: right;">263</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">343</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stellenbosch</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">340</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stockenstrom</td>
<td style="text-align: right;">279</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">318</td>
</tr>
</tbody>
</table>
</div>
<p>Now we can compare these mortality statistics during the pandemic</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>child_mortality</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>child_mort_rate</span>, <span class='va'>mort_rate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>size <span class='op'>=</span> <span class='va'>total</span>, colour <span class='op'>=</span> <span class='va'>race</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, se <span class='op'>=</span> <span class='cn'>F</span>, <span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"Both groups"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>race</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"lm"</span>, se <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_color_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='fl'>3</span>, name <span class='op'>=</span> <span class='st'>"Zissou1"</span>, type <span class='op'>=</span> <span class='st'>"continuous"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Child mortality rate"</span>,
       y <span class='op'>=</span> <span class='st'>"Pandemic mortality rate"</span>,
       size <span class='op'>=</span> <span class='st'>"District population"</span>,
       colour <span class='op'>=</span> <span class='st'>"Race group"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># lm_1 &lt;- child_mortality %&gt;%</span>
<span class='co'>#   lm(mort_rate ~ child_mort_rate, data = .)</span>
<span class='co'># </span>
<span class='co'># lm_2 &lt;- child_mortality %&gt;%</span>
<span class='co'>#   lm(mort_rate ~ child_mort_rate + race, data = .)</span>
<span class='co'># </span>
<span class='co'># stargazer::stargazer(lm_1, lm_2, type = "html")</span>
</code></pre>
</div>
</details>
</div>
<table style="text-align:center">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
mort_rate
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
child_mort_rate
</td>
<td>
0.132<sup>***</sup>
</td>
<td>
0.066<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.030)
</td>
<td>
(0.038)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
raceWhite
</td>
<td>
</td>
<td>
-0.020<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.008
</td>
<td>
0.028<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
28
</td>
<td>
28
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.425
</td>
<td>
0.544
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.403
</td>
<td>
0.508
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.017 (df = 26)
</td>
<td>
0.015 (df = 25)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
19.243<sup>***</sup> (df = 1; 26)
</td>
<td>
14.919<sup>***</sup> (df = 2; 25)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<h4 id="pre-pandemic-pneumonia-and-influenza-mortality">Pre-pandemic pneumonia and influenza mortality</h4>
<p><span class="citation" data-cites="AcuaSoto2011InfluenzaAP"><a href="#ref-AcuaSoto2011InfluenzaAP" role="doc-biblioref">Acuña-Soto, Viboud, and Chowell</a> (<a href="#ref-AcuaSoto2011InfluenzaAP" role="doc-biblioref">2011</a>)</span> show how influenza and pneumonia mortality prior to the pandemic are predictive of mortality rates during the pandemic in 66 large cities in the United States.</p>
<p>I follow their process here:</p>
<p>First I calculate the pre-pandemic mortality rates by district for influenza, pneumonia and both. These are shown in Table [cite] below.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pneumonia_influenza</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"data/pneumonia_influenza.rds"</span><span class='op'>)</span>
  
<span class='va'>pneumonia_influenza</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>influenza_deaths_grouped <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>influenza_deaths</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,
         pneumonia_deaths_grouped <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>pneumonia_deaths</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,
         pneumonia_influenza_deahts_grouped <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>pneumonia_influenza_deaths</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,
         total_grouped <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>total</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>influenza_deaths_grouped</span>, <span class='va'>pneumonia_deaths_grouped</span>, <span class='va'>pneumonia_influenza_deahts_grouped</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='op'>~</span><span class='va'>.x</span><span class='op'>*</span><span class='fl'>3</span> <span class='op'>/</span> <span class='va'>total_grouped</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'>where</span><span class='op'>(</span><span class='va'>is.numeric</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>.x</span><span class='op'>*</span><span class='fl'>1000</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>town</span>, .keep_all <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>pneumonia_influenza_deahts_grouped</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>influenza_deaths_grouped</span>, <span class='va'>pneumonia_deaths_grouped</span>, <span class='va'>pneumonia_influenza_deahts_grouped</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"District"</span>, <span class='st'>"Influenza"</span>, <span class='st'>"Pneumonia"</span>, <span class='st'>"Influenza and Pneumonia"</span><span class='op'>)</span>,
               caption <span class='op'>=</span> <span class='st'>"Influenza and Pneumonia mortality per 1000 residents"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-14">Table 6: </span>Influenza and Pneumonia mortality per 1000 residents</caption>
<thead>
<tr class="header">
<th style="text-align: left;">District</th>
<th style="text-align: right;">Influenza</th>
<th style="text-align: right;">Pneumonia</th>
<th style="text-align: right;">Influenza and Pneumonia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kuruman</td>
<td style="text-align: right;">4.28</td>
<td style="text-align: right;">4.28</td>
<td style="text-align: right;">8.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">Riversdale</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">5.76</td>
<td style="text-align: right;">8.94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vryburg</td>
<td style="text-align: right;">4.30</td>
<td style="text-align: right;">9.02</td>
<td style="text-align: right;">13.32</td>
</tr>
<tr class="even">
<td style="text-align: left;">Peddie</td>
<td style="text-align: right;">8.37</td>
<td style="text-align: right;">5.89</td>
<td style="text-align: right;">14.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mafeking</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">14.77</td>
<td style="text-align: right;">15.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">Elliot</td>
<td style="text-align: right;">7.28</td>
<td style="text-align: right;">11.79</td>
<td style="text-align: right;">18.72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fraserburg</td>
<td style="text-align: right;">5.21</td>
<td style="text-align: right;">20.85</td>
<td style="text-align: right;">26.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cradock</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">23.84</td>
<td style="text-align: right;">26.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Paarl</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">27.82</td>
<td style="text-align: right;">28.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stellenbosch</td>
<td style="text-align: right;">3.29</td>
<td style="text-align: right;">32.05</td>
<td style="text-align: right;">35.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Queenstown</td>
<td style="text-align: right;">8.02</td>
<td style="text-align: right;">29.17</td>
<td style="text-align: right;">37.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oudtshoorn</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">42.89</td>
<td style="text-align: right;">44.59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Komga</td>
<td style="text-align: right;">28.62</td>
<td style="text-align: right;">16.88</td>
<td style="text-align: right;">45.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stockenstrom</td>
<td style="text-align: right;">22.65</td>
<td style="text-align: right;">75.60</td>
<td style="text-align: right;">98.25</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pneumonia_influenza_mort</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"data/pneumonia_infleunza_mort.rds"</span><span class='op'>)</span>

<span class='va'>pneumonia_influenza_mort</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>pneumonia_influenza_mort</span>, <span class='va'>pandemic_mort_rate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>race</span>, size <span class='op'>=</span> <span class='va'>total_pop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, <span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>race</span><span class='op'>)</span>, se <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, <span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"Both groups"</span><span class='op'>)</span>, se <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'># theme(legend.position = "bottom") +</span>
  <span class='fu'>scale_color_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='fl'>3</span>, name <span class='op'>=</span> <span class='st'>"Zissou1"</span>, type <span class='op'>=</span> <span class='st'>"continuous"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='st'>"Pre-existing district level pneumonia and infleunza mortality"</span>,
    y <span class='op'>=</span> <span class='st'>"Pandemic mortality"</span>,
    caption <span class='op'>=</span> <span class='st'>"Note: mortality is measured as deaths per 1000 residents"</span>,
    colour <span class='op'>=</span> <span class='st'>"Race group"</span>,
    size <span class='op'>=</span> <span class='st'>"District population"</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<p>While the individual slopes are lower, there is still a strong correlation between pre-existing pneumonia and influenza mortality rates and the pandemic mortality rate in each district.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lm_1</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"data/influenza_mort.rds"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>pandemic_mort_rate</span> <span class='op'>~</span> <span class='va'>influenza_mort</span> <span class='op'>+</span> <span class='va'>race</span>, data <span class='op'>=</span> <span class='va'>.</span><span class='op'>)</span>

<span class='va'>lm_2</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"data/pneumonia_mort.rds"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>pandemic_mort_rate</span> <span class='op'>~</span> <span class='va'>pneumonia_mort</span> <span class='op'>+</span> <span class='va'>race</span>, data <span class='op'>=</span> <span class='va'>.</span><span class='op'>)</span>

<span class='va'>lm_3</span> <span class='op'>&lt;-</span> <span class='va'>pneumonia_influenza_mort</span> <span class='op'>%&gt;%</span> 
 <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>pandemic_mort_rate</span> <span class='op'>~</span> <span class='va'>pneumonia_influenza_mort</span> <span class='op'>+</span> <span class='va'>race</span>, data <span class='op'>=</span> <span class='va'>.</span><span class='op'>)</span>

<span class='co'># stargazer::stargazer(lm_1, lm_2, lm_3, type = "html")</span>
</code></pre>
</div>
</details>
</div>
<table style="text-align:center">
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
pandemic_mort_rate
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
influenza_mort
</td>
<td>
3.228<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.437)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
pneumonia_mort
</td>
<td>
</td>
<td>
1.370<sup>**</sup>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.511)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
pneumonia_influenza_mort
</td>
<td>
</td>
<td>
</td>
<td>
1.481<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
(0.431)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
raceWhite
</td>
<td>
-0.023<sup>***</sup>
</td>
<td>
-0.019<sup>***</sup>
</td>
<td>
-0.015<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.033<sup>***</sup>
</td>
<td>
0.029<sup>***</sup>
</td>
<td>
0.023<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.006)
</td>
<td>
(0.006)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
26
</td>
<td>
28
</td>
<td>
28
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.567
</td>
<td>
0.602
</td>
<td>
0.652
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.530
</td>
<td>
0.571
</td>
<td>
0.624
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.015 (df = 23)
</td>
<td>
0.014 (df = 25)
</td>
<td>
0.013 (df = 25)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
15.075<sup>***</sup> (df = 2; 23)
</td>
<td>
18.945<sup>***</sup> (df = 2; 25)
</td>
<td>
23.435<sup>***</sup> (df = 2; 25)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="3" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<h4 id="literacy-proxy">Literacy proxy</h4>
<p>I use a proxy for literacy of the individual’s family to assess if literacy has an impact on how well residents of a district fare during the pandemic. The hypothesis is that districts with higher literacy rates will better adopt the best practices proposed by health authorities in an attempt to quell the pandemic and stop the spread of the disease.</p>
<p>Table [Cite] shows that there is considerable variation in our literacy proxy by district and race.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>death_date</span> <span class='op'>&lt;</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>signed_yes_or_no <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>literate_proxy <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"maark|mark|merk|no|x"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"No"</span>,
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"yes"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Yes"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"No"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>race</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='st'>"NA"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>race</span>, <span class='va'>town</span>, <span class='va'>literate_proxy</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"literate_proxy"</span>, values_from <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>No</span>, <span class='va'>Yes</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'>replace_na</span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>share_literate <span class='op'>=</span> <span class='va'>Yes</span><span class='op'>/</span><span class='op'>(</span><span class='va'>Yes</span> <span class='op'>+</span> <span class='va'>No</span><span class='op'>)</span>,
         town <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>share_literate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>aggregate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Yes</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Yes</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>No</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>race</span>, <span class='va'>share_literate</span>, <span class='va'>aggregate</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"race"</span>, values_from <span class='op'>=</span> <span class='st'>"share_literate"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>aggregate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'>where</span><span class='op'>(</span><span class='va'>is.numeric</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='op'>~</span> <span class='fu'>percent</span><span class='op'>(</span><span class='va'>.</span>, accuracy <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"District"</span>, <span class='st'>"Aggregate"</span>, <span class='st'>"Black"</span>, <span class='st'>"Coloured"</span>, <span class='st'>"White"</span><span class='op'>)</span>,
               caption <span class='op'>=</span> <span class='st'>"Percentage of district death notices wherein Informant signed"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-17">Table 7: </span>Percentage of district death notices wherein Informant signed</caption>
<thead>
<tr class="header">
<th style="text-align: left;">District</th>
<th style="text-align: left;">Aggregate</th>
<th style="text-align: left;">Black</th>
<th style="text-align: left;">Coloured</th>
<th style="text-align: left;">White</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fraserburg</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">100%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sea Point</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">100%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Elliot</td>
<td style="text-align: left;">99%</td>
<td style="text-align: left;">99%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: left;">99%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stellenbosch</td>
<td style="text-align: left;">49%</td>
<td style="text-align: left;">49%</td>
<td style="text-align: left;">37%</td>
<td style="text-align: left;">96%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Paarl</td>
<td style="text-align: left;">45%</td>
<td style="text-align: left;">46%</td>
<td style="text-align: left;">37%</td>
<td style="text-align: left;">94%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cradock</td>
<td style="text-align: left;">45%</td>
<td style="text-align: left;">33%</td>
<td style="text-align: left;">36%</td>
<td style="text-align: left;">97%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vryburg</td>
<td style="text-align: left;">45%</td>
<td style="text-align: left;">29%</td>
<td style="text-align: left;">30%</td>
<td style="text-align: left;">99%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Riversdale</td>
<td style="text-align: left;">43%</td>
<td style="text-align: left;">50%</td>
<td style="text-align: left;">15%</td>
<td style="text-align: left;">90%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mafeking</td>
<td style="text-align: left;">42%</td>
<td style="text-align: left;">32%</td>
<td style="text-align: left;">51%</td>
<td style="text-align: left;">100%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Queenstown</td>
<td style="text-align: left;">40%</td>
<td style="text-align: left;">33%</td>
<td style="text-align: left;">30%</td>
<td style="text-align: left;">98%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oudtshoorn</td>
<td style="text-align: left;">37%</td>
<td style="text-align: left;">27%</td>
<td style="text-align: left;">21%</td>
<td style="text-align: left;">90%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kuruman</td>
<td style="text-align: left;">33%</td>
<td style="text-align: left;">16%</td>
<td style="text-align: left;">36%</td>
<td style="text-align: left;">96%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stockenstrom</td>
<td style="text-align: left;">17%</td>
<td style="text-align: left;">7%</td>
<td style="text-align: left;">32%</td>
<td style="text-align: left;">93%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Komga</td>
<td style="text-align: left;">11%</td>
<td style="text-align: left;">6%</td>
<td style="text-align: left;">14%</td>
<td style="text-align: left;">95%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Peddie</td>
<td style="text-align: left;">9%</td>
<td style="text-align: left;">6%</td>
<td style="text-align: left;">20%</td>
<td style="text-align: left;">97%</td>
</tr>
</tbody>
</table>
</div>
<p>Figure [cite] shows the same thing.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>death_date</span> <span class='op'>&lt;</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>signed_yes_or_no <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>literate_proxy <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"maark|mark|merk|no|x"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"No"</span>,
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"yes"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Yes"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"No"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>race</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='st'>"NA"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>race</span>, <span class='va'>town</span>, <span class='va'>literate_proxy</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"literate_proxy"</span>, values_from <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>No</span>, <span class='va'>Yes</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'>replace_na</span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>share_literate <span class='op'>=</span> <span class='va'>Yes</span><span class='op'>/</span><span class='op'>(</span><span class='va'>Yes</span> <span class='op'>+</span> <span class='va'>No</span><span class='op'>)</span>,
         town <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>share_literate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>share_literate</span>, <span class='va'>town</span>, fill <span class='op'>=</span> <span class='va'>race</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_fill_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='fl'>3</span>, name <span class='op'>=</span> <span class='st'>"Darjeeling1"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>position <span class='op'>=</span> <span class='st'>"dodge"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span> <span class='op'>~</span> <span class='va'>race</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>percent_format</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
</div>
<p>Is there an association between this proxy and the pandemic mortality rates?</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>town_race_mort_rates_pandemic</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"data/town_race_mort_rates.rds"</span><span class='op'>)</span>

<span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>death_date</span> <span class='op'>&lt;</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>signed_yes_or_no <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>literate_proxy <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"maark|mark|merk|no|x"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"No"</span>,
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"yes"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Yes"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"No"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>race</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='st'>"NA"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>race</span>, <span class='va'>town</span>, <span class='va'>literate_proxy</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"literate_proxy"</span>, values_from <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>No</span>, <span class='va'>Yes</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'>replace_na</span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>race <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>race</span>, <span class='st'>"White"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"White"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Black and Coloured"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>race</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>No</span>, <span class='va'>Yes</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='va'>sum</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>share_literate <span class='op'>=</span> <span class='va'>Yes</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>Yes</span> <span class='op'>+</span> <span class='va'>No</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>town_race_mort_rates_pandemic</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>share_literate</span>, <span class='va'>mort_rate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>race</span>, size <span class='op'>=</span> <span class='va'>total</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, <span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>race</span><span class='op'>)</span>, se <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, <span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"Both groups"</span><span class='op'>)</span>, se <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>percent_format</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'># need to choose a better colour</span>
  <span class='fu'>scale_color_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='fl'>3</span>, name <span class='op'>=</span> <span class='st'>"Zissou1"</span>, type <span class='op'>=</span> <span class='st'>"continuous"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Percentage of population with literacy proxy"</span>,
       y <span class='op'>=</span> <span class='st'>"Pandemic mortality per 1000 residents"</span>,
       size <span class='op'>=</span> <span class='st'>"District population"</span>,
       colour <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<p>We can also test for statistical correlation:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lm_1</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>death_date</span> <span class='op'>&lt;</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>signed_yes_or_no <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>literate_proxy <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"maark|mark|merk|no|x"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"No"</span>,
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"yes"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Yes"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"No"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>race</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='st'>"NA"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>race</span>, <span class='va'>town</span>, <span class='va'>literate_proxy</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"literate_proxy"</span>, values_from <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>No</span>, <span class='va'>Yes</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'>replace_na</span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>race <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>race</span>, <span class='st'>"White"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"White"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Black and Coloured"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>race</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>No</span>, <span class='va'>Yes</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='va'>sum</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>share_literate <span class='op'>=</span> <span class='va'>Yes</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>Yes</span> <span class='op'>+</span> <span class='va'>No</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>town_race_mort_rates_pandemic</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mort_rate</span> <span class='op'>~</span> <span class='va'>share_literate</span>, data <span class='op'>=</span> <span class='va'>.</span><span class='op'>)</span>

<span class='va'>lm_2</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>death_date</span> <span class='op'>&lt;</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"1918-09-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>signed_yes_or_no <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>literate_proxy <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"maark|mark|merk|no|x"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"No"</span>,
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>signed_yes_or_no</span>, <span class='st'>"yes"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Yes"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"No"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>race</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='st'>"NA"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>race</span>, <span class='va'>town</span>, <span class='va'>literate_proxy</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"literate_proxy"</span>, values_from <span class='op'>=</span> <span class='st'>"n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>No</span>, <span class='va'>Yes</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'>replace_na</span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>race <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>race</span>, <span class='st'>"White"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"White"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Black and Coloured"</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>race</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>No</span>, <span class='va'>Yes</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='va'>sum</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>share_literate <span class='op'>=</span> <span class='va'>Yes</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>Yes</span> <span class='op'>+</span> <span class='va'>No</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>town_race_mort_rates_pandemic</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mort_rate</span> <span class='op'>~</span> <span class='va'>share_literate</span> <span class='op'>+</span> <span class='va'>race</span>, data <span class='op'>=</span> <span class='va'>.</span><span class='op'>)</span>

<span class='co'># stargazer::stargazer(lm_1, lm_2, type = "html")</span>
</code></pre>
</div>
</details>
</div>
<table style="text-align:center">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
mort_rate
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
child_mort_rate
</td>
<td>
0.132<sup>***</sup>
</td>
<td>
0.066<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.030)
</td>
<td>
(0.038)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
raceWhite
</td>
<td>
</td>
<td>
-0.020<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.008
</td>
<td>
0.028<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
28
</td>
<td>
28
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.425
</td>
<td>
0.544
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.403
</td>
<td>
0.508
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.017 (df = 26)
</td>
<td>
0.015 (df = 25)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
19.243<sup>***</sup> (df = 1; 26)
</td>
<td>
14.919<sup>***</sup> (df = 2; 25)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Here we observe the Yule-Simpson effect in practice, how exciting! This statistical effect occurs when a true effect is marked by failing to control for an additional variable. In this case, the best fit line for “Both groups,” shown in yellow, leads us to believe that as the proportion of our district with the literacy proxy increases, the pandemic mortality decreases, in line with our hypothesis. However, when we control for race, we see that the effect is not significant and the sign is in fact in the opposite direction, as visible in the blue and red lines in the figure.</p>
<h4 id="percentage-of-foriegn-born-individuals-and">Percentage of foriegn born individuals and</h4>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>birth_place_shares</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"data/birth_place_shares.rds"</span><span class='op'>)</span>

<span class='va'>birth_place_shares</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>town <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>share_not_cape</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='co'># select(-contains("share"), -grand_total) %&gt;% </span>
  <span class='fu'>rename_with</span><span class='op'>(</span> <span class='op'>~</span> <span class='fu'>str_remove</span><span class='op'>(</span><span class='va'>.x</span>, <span class='st'>"total_"</span><span class='op'>)</span>, <span class='fu'>contains</span><span class='op'>(</span><span class='st'>"total_"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>cape</span>, <span class='va'>sa</span>, <span class='va'>africa</span>, <span class='va'>europe</span>, <span class='va'>other</span><span class='op'>)</span>, values_to <span class='op'>=</span> <span class='st'>"n"</span>, names_to <span class='op'>=</span> <span class='st'>"region"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>region <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>region</span>, <span class='st'>"cape"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Cape Province"</span>,
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>region</span>, <span class='st'>"sa"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Rest of South Africa"</span>,
    <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>region</span>, <span class='st'>"africa"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Rest of Africa"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>region</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>region <span class='op'>=</span> <span class='fu'>str_to_title</span><span class='op'>(</span><span class='va'>region</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>town</span>, fill <span class='op'>=</span> <span class='va'>region</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>position <span class='op'>=</span> <span class='st'>"fill"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_fill_manual</span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'>wesanderson</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/wesanderson/man/wes_palette.html'>wes_palette</a></span><span class='op'>(</span><span class='st'>"Darjeeling1"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"Proportion of residents born in"</span>,
       x <span class='op'>=</span> <span class='cn'>NULL</span>,
       y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-21-1.png" width="624" /></p>
</div>
<p>Visual correlation.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>birth_place_shares</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>town</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>pandemic_mort_grouped <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>deaths</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>total_pop</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>town</span>, <span class='va'>pandemic_mort_grouped</span>, <span class='va'>share_not_cape</span>, <span class='va'>grand_total</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>share_not_cape</span>, <span class='va'>pandemic_mort_grouped</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>size <span class='op'>=</span> <span class='va'>grand_total</span><span class='op'>)</span>, colour <span class='op'>=</span> <span class='st'>"midnightblue"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>percent_format</span><span class='op'>(</span>accuracy <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>number_format</span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Share of residents born outside the Cape Province"</span>,
       y <span class='op'>=</span> <span class='st'>"Pandemic mortality per 1000 residents"</span>,
       size <span class='op'>=</span> <span class='st'>"District population"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="spanish-flu-mortality_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<p>Statistical correlation</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lm_1</span> <span class='op'>&lt;-</span> <span class='va'>birth_place_shares</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>pandemic_mort_rate</span> <span class='op'>~</span> <span class='va'>share_not_cape</span>, data <span class='op'>=</span> <span class='va'>.</span><span class='op'>)</span>

<span class='co'># stargazer::stargazer(lm_1, type = "html")</span>
</code></pre>
</div>
</details>
</div>
<table style="text-align:center">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
pandemic_mort_rate
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
share_not_cape
</td>
<td>
-0.032
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.034)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.032<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.006)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
28
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.032
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
-0.005
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.022 (df = 26)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
0.869 (df = 1; 26)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-AcuaSoto2011InfluenzaAP" class="csl-entry" role="doc-biblioentry">
Acuña-Soto, R., C. Viboud, and G. Chowell. 2011. <span>“Influenza and Pneumonia Mortality in 66 Large Cities in the United States in Years Surrounding the 1918 Pandemic.”</span> <em>PLoS ONE</em> 6.
</div>
<div id="ref-Cowling2006" class="csl-entry" role="doc-biblioentry">
Cowling, Benjamin J, Irene O L Wong, Lai-Ming Ho, Steven Riley, and Gabriel M Leung. 2006. <span>“<span class="nocase">Methods for monitoring influenza surveillance data</span>.”</span> <em>International Journal of Epidemiology</em> 35 (5): 1314–21. <a href="https://doi.org/10.1093/ije/dyl162">https://doi.org/10.1093/ije/dyl162</a>.
</div>
<div id="ref-Dorrington2021" class="csl-entry" role="doc-biblioentry">
Dorrington, Rob, Debbie Bradshaw, Ria Laubscher, Pam Groenewald, and Tom Moultrie. 2021. <span>“<span>METHODOLOGICAL NOTE: PREDICTED NUMBERS OF DEATHS BY EPI-WEEK FOR SOUTH AFRICA IN 2020 AND 2021</span>.”</span> South African Medical Research Council. <a href="https://www.samrc.ac.za/sites/default/files/files/2021-01-24/Methodological Note on Predicted Weekly Deaths 20{\_}Jan{\_}2021.pdf">https://www.samrc.ac.za/sites/default/files/files/2021-01-24/Methodological Note on Predicted Weekly Deaths 20{\_}Jan{\_}2021.pdf</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
